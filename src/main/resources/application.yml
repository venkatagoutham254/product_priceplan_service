spring:
  profiles:
    active: postgres # Set the active profile here: 'mysql' or 'postgres'
  main:
    web-application-type: servlet
  
  # Cache configuration - disable Redis, use simple in-memory cache
  cache:
    type: simple

  liquibase:
    enabled: true
    change-log: classpath:/domain/changelog-master.yml
  servlet:
    multipart:
      max-file-size: 5MB
      max-request-size: 5MB

uploads:
  dir: uploads
  public-base-url: /uploads


server:
  port: 8080

# Actuator configuration for health checks
management:
  endpoints:
    web:
      exposure:
        include: health,info
      base-path: /actuator
  endpoint:
    health:
      show-details: when-authorized

aforo:
  jwt:
    issuer: aforo-productrateplans
    secret: ${JWT_SECRET:change-me-please-change-me-32-bytes-min}  # env var or fallback
    expiryMinutes: 120
  cors:
    allowed-origins: "http://13.115.248.133,http://54.221.164.5,http://localhost:3000,http://aforo.space,https://aforo.space,http://ui.dev.aforo.space,http://product.dev.aforo.space:8080,http://metering.dev.aforo.space:8092,http://usage.dev.aforo.space:8081,http://ingestion.dev.aforo.space:8088,http://kong.dev.aforo.space:8086,http://org.dev.aforo.space:8081,http://quickbooks.dev.aforo.space:8095,http://subscription.dev.aforo.space:8084"
    allowed-methods: "GET,POST,PUT,PATCH,DELETE,OPTIONS"
    allowed-headers: "Authorization,Content-Type,X-Organization-Id"
    allow-credentials: true

customer:
  service:
    url: http://org.dev.aforo.space:8081  #customer client (Route53)

billableMetrics:
  service:
    url: http://usage.dev.aforo.space:8081  #billable metrics client (Route53)

---
# PostgreSQL-specific configurations
spring:
  config:
    activate:
      on-profile: postgres
  datasource:
    url: jdbc:postgresql://localhost:5433/productrateplanservice
    hikari:
      driver-class-name: org.postgresql.Driver
    username: root
    password: P4ssword!
  jpa:
    hibernate:
      ddl-auto: update
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    properties:
      hibernate:
        jdbc:
          time_zone: UTC
  liquibase:
    enabled: false
    change-log: classpath:/domain/changelog-master.yml
  jackson:
    date-format: dd MMM, yyyy HH:mm z
    time-zone: UTC

springdoc:
  swagger-ui:
    display-operation-id: false
    display-request-duration: false
    default-models-expand-depth: 1
    default-model-expand-depth: 1
    doc-expansion: none
    operations-sorter: alpha
    tags-sorter: alpha
    display-operation-path: true
    custom-css-url: /swagger-ui/swagger-custom.css

---
# H2 Database configuration for testing
spring:
  config:
    activate:
      on-profile: h2
  datasource:
    url: jdbc:h2:mem:testdb
    driver-class-name: org.h2.Driver
    username: sa
    password: password
  h2:
    console:
      enabled: true
  jpa:
    hibernate:
      ddl-auto: create-drop
    database-platform: org.hibernate.dialect.H2Dialect
  liquibase:
    enabled: false

---
# MySQL-specific configurations
spring:
  config:
    activate:
      on-profile: mysql
  datasource:
    url: jdbc:mysql://localhost:3312/productrateplanservice
    hikari:
      driver-class-name: com.mysql.cj.jdbc.Driver
    username: root
    password: P4ssword!
  jpa:
    hibernate:
      ddl-auto: update
    database-platform: org.hibernate.dialect.MySQLDialect
  liquibase:
    enabled: false
    change-log: classpath:/domain/changelog-master.yml